# A Protein Language Model for Exploring Viral Fitness Landscapes
## 摘要  
连续出现的SARS-CoV-2变种导致了通过增强的传播潜力（即适应性）重复的疫情激增。建模基因型与适应性的关系使我们能够准确指出增强病毒适应性的突变，并在检测到高风险变种后立即进行标记。在此，我们介绍了CoVFit，这是一个蛋白质语言模型，能够仅根据其刺突蛋白序列预测变种的适应性。CoVFit的训练使用了从病毒基因组监测和与免疫逃逸相关的功能性突变数据中得到的基因型–适应性数据。仅限于在XBB出现前的可用数据，CoVFit成功预测了XBB谱系的更高适应性。经充分训练的CoVFit识别了直到2023年底SARS-CoV-2进化过程中的549个适应性提升事件。此外，基于CoVFit的模拟能够在检测到之前预测JN.1亚型的更高适应性。我们的研究提供了对SARS-CoV-2适应性格局的洞察，以及一种可能转变病毒基因组监测的新工具。  

## 引言

控制病毒性传染病的主要挑战之一源于病毒通过突变进化的能力。在COVID-19大流行期间，具有增强传播潜力（即适应性）的SARS-CoV-2变体在宿主群体中相继出现，导致了一次又一次的疫情激增。通过研究SARS-CoV-2的方式了解病毒如何在大流行中增强其适应性，我们可以获得管理COVID-19以及未来病毒性传染病的关键洞察。  

SARS-CoV-2变体的适应性可以通过有效再生数（Re）进行比较。Re代表在特定条件下，一个感染者引起的平均次级感染数。由于病毒基因组监测的进步，现在几乎可以实时估算SARS-CoV-2变体的相对Re。基于估计的相对Re，我们可以预测在特定时间内，在共同流行的病毒中哪个变体具有最大优势，可能会成为下一个主导变体。我们的团队，G2P-Japan联盟，已经成功使用Re估计来预测即将出现的主导变体，并通过病毒学实验进一步阐明了这些变体的特征和风险。  

由于变体在特定条件下的适应性由其基因型决定，原则上可以从其基因组或蛋白质序列预测变体的适应性。通过建立适应性预测模型，我们可以识别有助于增加病毒适应性的突变。此外，一个可靠的适应性预测模型将使变体监测系统更为高效，理想情况下能够在最初的基因组序列公布时即刻识别下一个主导变体。更重要的是，由于病毒通常朝着增加其适应性的方向进化，了解病毒的适应性格局可以预测其进化方向。  

SARS-CoV-2通过在病毒蛋白中获得突变（包括替换、插入和删除），尤其强调刺突（S）蛋白，来增强其适应性。S蛋白是病毒通过与血管紧张素转换酶2（ACE2）受体相互作用进入宿主细胞的必需糖蛋白。同时，S蛋白是中和抗体的主要靶标，这些抗体是疫苗接种或自然感染引发的体液免疫反应的关键组成部分。因此，能够影响S蛋白与ACE2的结合效率及其逃避中和抗体的能力的突变往往对病毒适应性有更强的影响。  

SARS-CoV-2的进化过程可以分为顺序和非顺序（或跃变式）两种。Omicron BA.1、BA.2、XBB和BA.2.86谱系是通过跃变式过程出现的，通过各种机制（包括重组等）在S蛋白中获得了大约15个以上的突变。相比之下，Omicron BA.5、BQ.1.1及XBB的后代是从其亲本谱系顺序进化而来的，在S蛋白中获得的突变数量较少，通常为三个或更少。预测通过跃变式进化出现的变体的适应性，预计将比通过顺序进化出现的变体更具挑战性。  

以往的研究，包括我们的研究，已经开发出了基于变体的突变模式预测其适应性的方法，这些方法采用统计建模方法。然而，这些统计模型仅将适应性表示为个别突变效应的线性组合，没有考虑突变之间的相互作用，即上位性。此外，这些统计模型无法考虑到训练数据集创建时尚未出现的突变的效应。我们认为，这些挑战可以通过使用创新的蛋白质语言模型来解决。大型语言模型（LLMs）在自然语言处理领域越来越受欢迎。蛋白质语言模型是在蛋白质序列的综合数据集上预训练的LLMs，使其能够学习蛋白质的一般模式。值得注意的是，我们可以对预训练的蛋白质语言模型进行微调，以解决特定任务，如适应性预测。此外，通过采用适用于深度学习模型（如蛋白质语言模型）的多任务学习框架，我们可以将突变的功能信息整合到适应性预测过程中，从而可能提高模型的预测准确性。  

在这项研究中，我们开发了CoVFit，这是一个利用最先进的蛋白质语言模型ESM-2，基于S蛋白预测SARS-CoV-2变体适应性的模型。我们使用基于病毒基因组监测估计的基因型-适应性信息，以及通过高通量深度突变扫描（DMS）实验确定的关于逃避体液免疫能力的突变效应信息，对定制的ESM-2模型进行了微调。此外，使用CoVFit，我们描绘了直到2023年底的SARS-CoV-2适应性格局。  

## 结果
### 引入CoVFit
我们开发了CoVFit，这是一个基于S蛋白序列的适应性预测模型，通过对ESM-2进行微调（见图1A）。为了增加模型对冠状病毒S蛋白的了解，我们首先通过对从1506种冠状病毒中获得的S蛋白序列进行额外的预训练（即领域适应），建立了ESM-2Coronaviridae（见图1B和图S1）。ESM-2Coronaviridae模型在特定于SARS-CoV-2 S蛋白的掩码学习任务中表现出增强的预测能力，同时保持在更广泛的蛋白质集合中的性能（见图S1C）。随后，利用多任务学习框架，我们在基因型–适应性（Re）数据和DMS数据上对模型进行了微调，用于评估抗体中和逃逸能力（见图1B）。因此，对于给定的S蛋白序列，CoVFit可以预测特定国家的适应性值及其从每种单克隆抗体（mAb）逃逸的能力（见图S1A）。 

![fig1](/Figures/fig1.png)

图 1 CoVFit概览。   
A) CoVFit的概念框架。CoVFit是一个蛋白质语言模型，旨在根据SARS-CoV-2变体的S蛋白序列预测其相对适应性（Re）。    
B) 用于开发CoVFit模型实例的训练过程概述。  

为了组建基因型–适应性数据集，我们首先将病毒序列分类为S蛋白基因型，定义为一组共享S蛋白中一组独特突变的病毒。随后，我们通过将多项逻辑模型拟合至2023年11月2日前从GISAID（https://gisaid.org/） 获得的基因组监测数据，估算了每个基因型在每个国家的Re，如之前所述。因此，我们获得了总共21,751个基因型–适应性数据点，涵盖了17个国家中的12,914个基因型（见图1B和图S2A）。与先前的研究一致，后期出现的变体展示出更高的Re值，表明变体的Re在进化过程中逐渐增加（见图S2A）。  

我们利用了由Cao等人产生的关于单克隆抗体（mAbs）中和能力的体外DMS数据集。该数据集包含173,384个突变–mAb DMS数据点，涵盖S蛋白受体结合域（RBD）中的2,096种类型的突变和1,548种mAbs（见图1B和图S2B）。与先前的发现一致，突变对mAbs的影响因其抗原表位类别而异（见图S2B、S2C和S2D）。表现出更高适应性的变体，如BQ.1.1或XBB，显示出增强的逃避这些mAbs的能力，支持利用这些信息预测适应性的有效性（见图S2D）。  

使用五折交叉验证方案，我们生成了五个CoVFit模型实例（见图1B）。这些模型实例用于评估相应测试数据的性能。此外，这些实例可以为新数据（例如，在模型训练后获得的数据）提供预测的均值和方差。从此以后，这些模型实例被称为CoVFitNov23（下标表示获得基因型-适应性数据的月份和年份）。 

### CoVFit的预测性能
为了评估CoVFitNov23模型实例的预测性能，我们检查了各个模型实例使用相应测试数据集的预测性能。结果显示，适应性的预测性能非常高（Spearman相关性：0.992）（图2A和2B）。该模型成功预测了后期出现变体的更高适应性（图2C）。此外，对mAbs中和逃逸能力的预测也达到了中等至高的性能（每个抗原表位类的Spearman相关性：0.551-0.810）（图2A和S3A）。模型的较高预测性能也在按采样国家和mAb类型分层的适应性和免疫逃逸能力评估中得到了支持（图S3B和S3C）。综合来看，我们展示了CoVFit足以代表适应性格局以及突变对多种类型mAbs逃逸效应的影响。 
![fig2](/Figures/fig2.png)
图 2 CoVFit的预测性能。  
A) 预测的相对适应性值和mAb中和逃逸分数的Spearman相关性得分。每个交叉验证折的得分由一个点表示，均值（条形图）和标准差（误差线）也显示出来。在每个表位群中计算mAbs的相关性。  
B) 适应性预测的散点图，汇总了五折交叉验证的结果。每个点代表特定国家中某个病毒基因型的结果。点按Nextclade谱系进行着色。相对适应性值进行了缩放，使得0.1百分位数和99.9百分位数的点落在0和1之间。显示了一条斜率为1且截距为0的虚线。  
C) 散点图继承自（B），但按每个基因型的出现日期进行着色。  
 
### CoVFit对未知、未来变体的预测性能
这项研究旨在开发一种预测模型，能够准确评估尚未出现的变体以及已知变体的适应性。然而，对于模型未知的变体，特别是那些在模型创建后出现的未来变体的预测性能无法评估，如果训练数据包含与测试数据集高度相似的变体，就像上面的性能测试一样（图2）。为了评估模型对这些未来变体的性能，我们通过根据变体出现日期将现有基因型-适应性数据集分为“过去”和“未来”变体，生成了数据集（图3A）。随后，我们仅使用过去变体数据集生成了五个CoVFit实例，并使用五折交叉验证方案，然后评估其对未来变体数据集的性能。  
![fig3](/Figures/fig3.png)

图 3 CoVFit对未知未来变体的预测性能。  
A) 评估未来变体预测性能的策略。被称为CoVFitAug22的模型实例，使用在2022年8月31日之前出现的变体数据进行训练。然后在此日期之后出现的变体数据上评估模型对未来变体的预测性能。  
B) 适应性预测的散点图，汇总了五折交叉验证的结果。包括过去的（浅灰色）和未来的（灰色）变体。对于未来变体，显示了五折交叉验证数据集的平均预测。使用平均预测值计算未来变体的Spearman相关性。显示了一条斜率为1且截距为0的虚线。  
C) 仅包括未来变体的适应性预测散点图。显示了五次预测结果的平均值（点）和标准差（误差线）。颜色表示Nextclade谱系分类。除了斜率为1且截距为0的线（黑色），还显示了基于平均预测值的估计线性回归线（灰色）。  
D) 散点图继承自（C），但按照变体是否属于XBB谱系进行着色。  
E) 各国未来变体适应性的Spearman相关性得分。  
F) 主要变体之间预测适应性的比较。显示了每个国家的预测适应性值（顶部）、各国观察到的平均适应性值（第二顶部）、定义这些变体的代表性突变（第二底部）和包括在过去数据集中的变体序列数量（底部）。  
G) 方法之间预测性能的比较。显示了Spearman相关性得分（顶部）和估计回归斜率（底部）。每个交叉验证折的得分由一个叉表示，平均值（点）和标准差（误差线）。灰色数字表示平均值。  

基因型-适应性数据集因此使用2022年8月31日的截止日期进行了划分。应用此截止日期，Omicron系列在2022年末至2023年间出现的，包括BQ.1（及其亚系BQ.1.1；支系22E）、CH.1.1（支系23C）、XBB系列（支系22F、23A、23B、23D、23E和23F）和BA.2.86（支系23I）被排除在过去的数据集之外（图3A）。这个截止日期使我们能够测试在两种不同的进化情景下适应性提升的预测性能：顺序进化（BQ.1和CH.1.1分别从BA.5和BA.2.75出现）和跃变式进化（XBB从BA.2出现）。

经过训练的模型实例，CoVFitAug22，成功预测了未来变体的适应性高于过去变体（图3B）。此外，尽管CoVFitAug22倾向于低估未来变体的适应性（估计斜率：0.380），但在这些未来变体中仍观察到较高的正相关性（Spearman相关性：0.761）（图3C和3D）。在每个国家分层分析的结果中观察到未来变体的正相关性是稳健的（图3E）。这些结果表明CoVFitAug22具有预测未来变体相对适应性的能力。此外，虽然XBB系列在出现时在S蛋白中有14个独特的突变，CoVFitAug22成功预测了XBB系列相对于其他未来变体（包括BQ.1.1）的更高适应性，这突显了CoVFit的高度概括性（图3D）。  

为了提供CoVFitAug22性能的更详细评估，我们比较了主要变体的预测适应性（图3F）。在BA.5系列中，BQ.1通过获得K444T和N460K替代从BA.5演化而来。BQ.1.1随后从BQ.1演化而来，获得了额外的R346T替代。CoVFitAug22成功预测了从BA.5到BQ.1.1的顺序演化过程中的适应性提升。同样，它成功预测了CH.1.1（BA.2.75的后代，具有R346T, K444T, L452R和F486S替代）比BA.2.75具有更高的适应性。此外，CoVFitAug22成功预测了通过获得F486P这一关键替代使XBB成为主导支系的XBB系列的适应性增加。这种准确性值得注意，考虑到过去的数据集没有包括XBB序列。另一方面，CoVFitAug22未能准确预测EG.5.1和HK.3等变体相比于XBB.1.5的适应性增加，而是将它们视为大多数国家的等效变体。  

接下来，我们设定了一个额外的计算实验，以评估该模型对BA.2.86的预测性能，这是另一个通过类似跃变的进化从BA.2衍生出的谱系，其特征是在S蛋白中获得了大约30个突变（图S4）。在此分析中，根据2023年7月31日的截止日期将适应性数据集分割，以排除过去数据集中的BA.2.86谱系（包括其后代谱系JN.1）（图S4）。然后我们生成了额外的模型实例，CoVFitJul23，使用这个过去的数据集。在使用相应的未来数据集评估时，CoVFitJul23成功预测了BA.2.86相比其亲本谱系BA.2以及其他谱系包括BA.5、BQ.1和XBB的更高适应性（图S4B）。然而，它未能预测BA.2.86相比XBB的后代谱系如XBB.1.5、EG.5和HK.3的更高适应性。我们的分析展示了CoVFit的高度泛化能力，同时也提供了对其局限性的洞察，这些综合来看，使得其结果的负责任解读以及对变体适应性的具体预测成为可能。  

### 性能比较以及与其他预测模型的比较
为了评估将DMS数据纳入CoVFit对适应性预测效能的影响，我们生成了一个额外的模型实例CoVFitnoDMS，通过不使用DMS数据集进行训练，随后评估其预测性能与原始模型的对比（图3G和S5）。这个简化模型通过使用过去-未来变体数据分割方法进行实验评估，截止日期为2022年8月31日。在预测过去变体的适应性时，CoVFitnoDMS展示出与原始CoVFit相似的预测性能，无论是Spearman相关性还是估计的回归斜率。然而，在预测未来变体的适应性时，CoVFitnoDMS表现明显不足。同样，我们检查了领域适应步骤对预测性能的影响，并展示了这一步骤在实现更高性能中的贡献（图3G和S5）。去除DMS数据集的影响比省略领域适应步骤的影响更大，强调了DMS数据集整合的关键作用。总体而言，CoVFit的卓越预测性能可归因于其纳入突变的功能信息以及应用领域适应框架。  

接下来，为了评估CoVFit与其他方法的性能对比，我们构建了使用非深度学习方法的替代预测模型，如LASSO、随机森林和轻量梯度提升机（LightGBM）（图3G和S5）。在预测过去变体的适应性时，这些模型展示出与CoVFit相似的预测性能，无论是Spearman相关性还是估计的回归斜率。然而，在预测未来变体的适应性时，CoVFit超过了线性模型（LASSO）和更复杂的决策树基础模型（随机森林和LightGBM）。特别是，CoVFit的回归斜率估计显著高于其他模型，表明CoVFit在预测中的低估偏差比其他方法小。  

### 适应性提升事件在SARS-CoV-2进化中的作用

为了深入了解SARS-CoV-2的适应性格局，我们开发了基于CoVFit的系统发生学框架，分析其进化过程中的适应性提升（图4）。首先，我们构建了一个包含11,098个变体的系统发生树，这些变体对应于编码各自S蛋白基因型的病毒基因组序列。随后，我们重建了树内部节点的祖先S蛋白序列（图4A）。然后，我们利用最新的CoVFitNov23模型推断了所有节点的适应性，这些节点代表了观察到的和重建的祖先序列（图4B及Omicron和所有谱系的图S6）。我们使用五折交叉验证方案生成的模型实例，为每个节点获得了五个预测的适应性值及其平均值和标准误差。最后，我们通过比较给定节点与其父节点之间的预测适应性值，识别了适应性提升在统计上显著的分支（误差发现率；FDR<0.1）。 

![fig4](/Figures/fig4.png)
图 4 检测奥密克戎分化过程中的适应性提升事件。  
A) 利用CoVFit模型检测具有适应性提升的系统发育分支的方案。  
B) 通过奥密克戎的演化推断适应性变化。显示了奥密克戎系列的最大似然（ML）树。分支颜色表示每个系统发育节点的推断适应性值，包括系统发育树中观察到的和重建的S蛋白祖先基因型。  
C) 在奥密克戎的演化过程中检测适应性提升事件。点颜色表示每个分支的推断适应性增益，计算方法是节点与其父节点之间预测适应性的差异。  
D) 奥密克戎演化过程中特定突变的平均适应性增益。由于一些突变被多次获得，适应性增益的平均值被用作“每次突变的适应性增益”得分。展示了与此得分相关的前20个突变及其蛋白质结构域信息。  
E) RBD中与适应性相关的突变的富集，尤其是在其RBM中。负分数被修剪至0。  
F) 在祖先D614G S蛋白的3D结构上（PDB: 7BNN）49 映射逐位点适应性增益得分。如果特定位点存在多种突变类型，则显示为“每个位点的适应性增益”最高值。关于此得分的前15个位点的氨基酸侧链以球形显示。图由Chimera X50生成。  
G) 适应性增益排名与平均mAb逃逸得分的关联。这个逃逸得分是通过mAb上的突变计算的逃逸得分的平均值。ND组包括在我们的系统发育分析中未观察到的突变。  
H) 每次突变的适应性增益得分与推断的获得次数的关联。使用所有突变的泊松回归显示了估计的回归曲线（线）和标准误差（带）。此外，显示了使用所有突变、RBD突变和非RBD突变的泊松回归分析的Nagelkerke的伪R2值。  

在获得S蛋白突变的9,846个分支中，有549个（5.6%）分支被识别为显著适应性提升（图S6），包括Omicron谱系中的334个分支（图4C）。我们观察到，在代表主要谱系的最近共同祖先（MRCA）的分支以及在其后续多样化过程中，病毒适应性均有所增加（图4C和S6）。  

为了识别对适应性提升至关重要的突变，我们接下来通过检查获得单个突变的分支，计算了每个突变的平均适应性增益（Omicron和所有谱系的图4D和S6）。在S蛋白的受体结合域（RBD）中，特别是在其受体结合基序（RBM）中发现了适应性增益较高的突变，该基序由与ACE2的结合界面组成（图4E, 4F和S6）。此外，我们还识别了显著的非RBD突变，如N端域的Y144和H146缺失。我们发现，对适应性提升影响较大的突变也往往增强了病毒逃避体液免疫的能力（图4G）。此外，Omicron谱系中对适应性影响显著的突变倾向于在Omicron的进化过程中以趋同的方式多次获得（图4H）。这种关联在RBD突变中很明显（Nagelkerke的伪R2：0.416），但在非RBD突变中则不明显（Nagelkerke的伪R2：0.022）。  

### F456L替换的背景特定效应

我们发现，某些突变在特定的系统发生谱系中过度代表。例如，虽然R346T替换在Omicron谱系中趋同获得，但F456L替换在XBB谱系中明显过度代表（图5A）。为了量化F456L在不同谱系中的适应性效应差异，我们执行了体外突变扫描分析，利用CoVFitNov23通过计算在各种S蛋白骨架中诱导F456L，推断由此替换引起的适应性增益（图5B）。预测的F456L在XBB谱系中的适应性增益明显高于其他谱系。这些结果表明，F456L增加适应性的影响特定于XBB谱系。  

![fig5](/Figures/fig5.png)
图 5 F456L替换的特定环境效应。 
A) 特定替换的趋同获得例子。节点表示获得事件，节点颜色表示获得事件时的适应性增益。分支颜色表示在重建的祖先S蛋白序列中特定替换的存在（灰色）或缺失（浅灰色）。 
B) 使用CoVFit进行体外突变扫描推断的，每个骨架S蛋白序列中F456L的适应性增益。
C) 基于曹的DMS数据29，由mAb逃逸估计器32估计的祖先D614G菌株、BA.2和XBB变体的逐位免疫逃逸得分。关于逃逸得分的前5个位点进行了注释。 
D) F456L对S蛋白表达（稳定性）和ACE2结合亲和力的影响，从Taylor和Starr31的公开可用DMS数据中提取。点颜色表示在(B)中显示的推断适应性增益。较高的值表示增强的表达和ACE2结合亲和力值。 

为了获得关于XBB特异的F456L效应对病毒适应性的机械洞察，我们分析了已发表的DMS数据。这包括Cao等人的mAb中和数据以及Taylor和Starr的RBD ACE2结合亲和力和蛋白稳定性数据。根据逃逸估算器数据，在包括祖先D614G菌株的S蛋白在内的各种谱系中，F456处的替换对中和逃逸的影响是最大的（图5C）。另一方面，这种突变在ACE2结合和蛋白表达上的效果因S蛋白背景而异。虽然F456L增强了XBB S蛋白的ACE2结合和蛋白表达，但这种替换在所有测试的S背景中对ACE2结合和/或蛋白表达有负面影响（图5D）。F456L在ACE2结合和表达上的非破坏性效果，独特于XBB，在之前的研究中的RBD和完整S DMS试验中已得到确认。这些结果表明，F456L在XBB的S蛋白上提供了优先效果，但在其他谱系的S蛋白上具有双刃剑效果。总的来说，F456L在适应性上的XBB特异性正面效应可以通过XBB特有的去除这种突变的有害效应来解释。这个例子验证了CoVFit在背景特定方式推断突变效应的有效性。  

### 基于CoVFit的体外突变扫描（DMS）预测潜在变体的适应性

为了展示CoVFit在预测适应性增强的变体出现方面的实用性，我们开发了一种模拟方法，即基于CoVFit的体外DMS。在这种方法中，我们在计算上将每一种可能的单个氨基酸替换引入到JN.1（BA.2.86.1.1）——截至2024年3月的主导变体的S蛋白中。随后，使用CoVFitNov23推断每种替换的适应性增益。值得注意的是，CoVFitNov23的训练数据集仅包括JN.1的单个序列，没有其后代谱系的序列。  

这种体外DMS分析确定了位点F456、K478和R346的替换具有最高的预测适应性增益（图6A和6B）。为了验证这些预测，我们将它们与2024年3月11日的最新基因组监测数据进行了比较。值得注意的是，携带F456、K478、R346或F456和R346组合替换的新兴JN.1亚系正在全球JN.1群体中迅速扩张（图6C）。这些结果表明CoVFitNov23成功预测了这些JN.1亚系相较于其亲本JN.1的更高适应性——有效地在它们出现或被检测到之前。综合来看，这些结果突显了基于CoVFit的模拟分析能力，能预先预测具有更高流行潜力的变体的出现。 

![fig6](/Figures/fig6.png)
图 6 基于CoVFit的JN.1变体体外DMS研究。 
A) 使用CoVFitNov23对JN.1的S蛋白进行体外DMS推断的氨基酸位点的适应性增益[每个位点]得分排名。仅显示得分为正的位点。 
B) 热图描述了每种氨基酸替换的推断适应性增益。 
C) JN.1人群中带有特定氨基酸位点替换的JN.1亚型的频率变化。使用2023年12月1日至2024年2月29日的基因组监测数据。频率使用7天间隔计算。每个病毒组的总序列数为1166。 

### CoVFit-CLI工具

训练好的CoVFitNov23模型实例可作为命令行工具CoVFit-CLI，从我们的GitHub仓库（https://github.com/TheSatoLab/CoVFit） 获取。研究人员可以使用这个独立程序方便地为他们自己的SARS-CoV-2 S蛋白序列提供适应性和DMS逃逸预测。CoVFit-CLI工具将定期更新模型实例，训练的基于最新的基因组监测数据。  

## 讨论

在这项研究中，我们建立了CoVFit，一个蛋白质语言模型，用以预测SARS-CoV-2变体的相对适应性，具有高泛化性。以前的研究提出了预测与适应性强烈相关的病毒表型的机器学习模型，如免疫逃逸能力或蛋白质语法性。然而，据我们所知，CoVFit是第一个旨在直接预测病毒适应性（即Re）的机器学习模型，这代表了变体在宿主群体中的传播能力。此外，我们证明CoVFit可以用来理解SARS-CoV-2的适应性格局，并在变体出现前或刚刚检测到后即时标记出具有更高传播潜力的变体。  

CoVFit模型实例（CoVFitSep22）成功预测了由顺序进化导致的适应性增加，特别是从BA.5到BQ.1.1以及从BA.2.75到CH.1.1。此外，模型实例也成功预测了导致XBB谱系出现的跃变式进化中的适应性增加（图3）。此外，模型实例还成功预测了XBB谱系在获得F486P突变的顺序适应性提升的第一步。这种强大的泛化能力是显著的，因为在XBB出现期间通过重组在S蛋白中获得了14个突变。这种能力主要是通过对变体适应性和突变对免疫逃逸能力影响的知识进行多任务学习获得的（图3G）。另一方面，我们还展示了当前模型并不完全准确地泛化到所有情况。例如，CoVFit模型实例（CoVFitSep22和CoVFitJul23）低估了BA.2.86出现时的适应性提升，其中一次性获得了大约30个突变（图S4）。尽管存在这种低估，但值得注意的是，该模型确实成功预测了BA.2.86相较于其祖先菌株BA.2以及随后相继出现的谱系如BA.5、BQ.1.1和XBB的显著更高的适应性。  

CoVFit有潜力改变对具有更高流行风险的SARS-CoV-2变体的基因组监测。随着SARS-CoV-2疫情的延续和当前基因组监测努力的减少，能够直接从基因型预测新出现变体的适应性的方法变得越来越重要。通过使用CoVFit扫描在病毒基因组监测数据库中新注册的病毒基因组，我们预期可以在前所未有的早期阶段识别可能具有更高适应性的变体，理想情况下在注册单个序列时就可以。这种方法允许直接检测具有更高适应性的病毒，绕过识别和命名新变体的步骤，这通常需要在公共论坛上手动指定。这种效率使得变体监测可以在更少的时间和更少的人力投入下继续进行。此外，使用CoVFit进行体外DMS的潜力可以预测在实际出现或检测之前具有高适应性的变体，正如通过成功预测具有增强生长优势的JN.1亚系所示（图6）。鉴于CoVFit的有效培训过程，该过程可以在大约24小时内完成每个模型实例的培训，使用单个Nvidia A100 GPU，CoVFit模型可以定期更新，以纳入关于最新变体的信息（见方法）。总之，一个高效的监测系统，实现最新CoVFit实例的开发将是未来工作的重点。  

在这项研究中，我们开发了一个结合CoVFit和系统发生方法的框架，以识别增强病毒适应性的突变（图4和5）。尽管在机器学习模型中普遍面临解释性的挑战，我们的框架旨在评估特定突变的平均效应以及它们的背景特定或上位性效应。例如，它能够区分特定突变（如F456L）在不同背景中（如在XBB谱系内与其他谱系之间）的不同影响（图5）。这个框架是体外DMS的宝贵补充。与体外DMS相比，这种方法旨在回顾性地解释观察到的进化步骤，并识别其出现的模式。  

以前的研究报告称，一些突变在SARS-CoV-2的进化过程中可能由于这些趋同突变对病毒适应性有积极影响而被趋同获得。实际上，一些研究根据突变被趋同获得的频率推断了突变对病毒适应性的重要性，假设这两个特征是相关的。然而，尽管我们之前的调查集中在有限的突变集上，突变的获得频率与其对适应性的影响之间的关联程度仍然不清楚。在本研究中，我们全面调查了这个问题，并发现这两个特征之间存在关联，尤其是在受体结合域（RBD）中的突变观察到特别强的相关性（图4H）。这一结果表明，为了准确预测病毒的进化，考虑突变的获得频率及其适应性效应是有效的。通过将未来的发展引向基于系统动力学方法的机器学习模型，整合这两个因素，我们可能能够实现精确的病毒进化预测和模拟。  

尽管CoVFit具有实用性，但其目前形式仍有几个局限性。首先，作为目标变量，我们使用了从病毒基因组监测数据估算的变体适应性（Re），这本身带有一定的不确定性和偏差。这种偏差部分是因为监测不采用随机抽样。通常，特定感染群体的样本在监测数据中被不成比例地代表，可能导致对某些变体适应性的估计存在偏差。其次，用于估计变体适应性的逻辑模型在一个强假设下运行，即变体之间的相对适应性随时间保持不变。虽然这个模型被广泛使用，但这个假设可能并非总是成立。实际上，变体的相对适应性可能会因宿主群体免疫状态的变化而变化，受到自然感染和疫苗接种等因素的影响。第三，在我们的适应性预测任务中，我们使用了来自现实世界变体的序列作为训练输入。对适应性有显著负面影响的突变在我们的训练数据集中必定被低估，因为这样的突变通常会通过自然选择被淘汰。因此，CoVFit可能会低估某些突变对适应性的负面影响。此外，应注意当前模型倾向于低估未来变体的适应性（图3）。其他技术限制及其潜在解决方案在方法部分的CoVFit改进空间中进行了讨论。综合来看，我们模型所作的适应性预测应在补充信息的背景下谨慎解读。   

尽管有上述限制，CoVFit具有解析病毒适应性格局的潜力。我们的方法有望为早期预测未来流行病变体和推进病毒进化预测的创新方法做出贡献。这些进展对于有效的流行病控制、疫苗开发和药物发现至关重要。此外，CoVFit中使用的方法论可以应用于预测其他病毒（包括引起未来大流行的病毒病原体）的适应性。鉴于下一次大流行的预期，不断发展基础生物信息学方法以协助流行病控制是至关重要的，利用SARS-CoV-2作为典型的大量基因组数据努力。  

## 方法
### 基因型-适应性数据集的准备
我们从GISAID (https://gisaid.org/)  检索了截至2023年11月2日的所有SARS-CoV-2基因组序列及其相关元数据。然后，我们使用Nextclade v.2.14.0以及“2023-10-26T12:00:00Z”版本的Nextclade数据集，为数据集中的每个序列分配了当时可用的最新PANGO谱系分类。接着，我们根据以下标准排除了低质量序列：(i) 缺少采集日期信息；(ii) 样本来源于非人类动物；或 (iii) 未确定核苷酸字符超过1%。  

为了开发一个比PANGO谱系更高分辨率的SARS-CoV-2分类系统，仅基于S蛋白序列，我们定义了S蛋白的基因型，并在本研究中使用它作为病毒分类系统。S蛋白基因型指的是分享S蛋白中一组独特突变的病毒序列组。为实现这一点，我们首先识别了在100个以上序列中观察到的S蛋白中的突变。然后我们分析了每个序列中的突变模式，使我们能够根据这些模式将序列分类为不同的基因型。只有在任何国家被20个或更多序列代表的基因型才被纳入我们的分析。结果，我们的数据集中包含了13,643个S蛋白基因型。每个基因型都与Nextclade PANGO谱系、Nextclade支系和代表性基因组序列相关联。这个代表性序列是从该基因型的序列集合中随机选取的。一个基因型的出现日期被确定为该基因型内病毒分离物的采集第1百分位日期。这个数据集中包含的病毒基因组序列在GISAID网站上归纳为EPI_SET_ID: EPI_SET_240311ma。  

为了估计每个基因型在每个国家的相对Re值，我们首先统计每个国家数据集中每个基因型的日计数。我们应用多项逻辑模型到每个国家的计数数据，并使用R v.4.2.1中的‘nnet’包的‘multinom’功能估计参数。然后我们提取了每个基因型相对于参考基因型的估计生长率（斜率参数）。参考基因型被选为在检测量最低的国家检测量最高的一个。因此，选择BA.5谱系的主要基因型（在PANGO谱系中等同于BA.5.2.1）作为参考。每个病毒谱系的相对Re，𝑟l，根据斜率参数βl计算为𝑟(l) = exp(γβl)，其中β!和𝑟(l)分别是病毒谱系l的逻辑斜率参数和相对Re，γ是平均病毒代时间（2.1天）(http://sonorouschocolate.com/covid19/index.php?title=Estimating_Generation_Time_Of_Omicron )。这个模型有两个强假设：变体之间的相对适应性随时间保持不变，所有变体具有相同的平均病毒代时间。每个基因型的估计Re值在表S1中总结。  

在训练步骤之前，我们从数据集中排除了含有超过5个不明字符和超过30个氨基酸缺失的S蛋白序列。此外，我们专注于检测到超过300个基因型的国家，这导致保留了17个国家的数据：澳大利亚、比利时、巴西、加拿大、丹麦、法国、德国、印度、意大利、日本、荷兰、韩国、西班牙、瑞典、瑞士、英国和美国。由于这种额外的筛选，共有21,571个基因型-适应性（相对Re）数据点，涵盖17个国家的12,914个基因型，被纳入我们的基因型-适应性数据集。估计的适应性值使用自然对数函数转换，然后数据被缩放，使得0.1百分位和99.9百分位点落在0到1之间，然后进行模型训练。  

### 引入CoVFit

我们开发了CoVFit，这是一个基于S蛋白序列的适应性预测模型，通过对ESM-2蛋白语言模型进行精细调整（图1A）。为了提高模型的性能，我们采用了三种关键技术：领域适应、多任务学习和低秩适应（LoRA）42。领域适应是使用自定义数据集的额外预训练阶段。在本研究中，我们使用来自各种人类和动物冠状病毒的S蛋白序列进行了领域适应（见领域适应的数据准备部分）。这种技术使模型更好地学习了这些蛋白的一般属性（见领域适应部分）。多任务学习是一种同时在不同类型数据上训练模型的框架，它允许模型捕捉跨任务共享的关键信息，从而增强其泛化能力。在CoVFit中，模型使用总共1,565个回归任务进行了微调，包括预测17个国家的适应性值和预测1,548种mAbs的相对结合亲和力（见CoVFit模型架构部分）。最后，LoRA是一种高效微调大型模型的技术，它减少了GPU内存资源的需求，同时不影响模型的预测性能。LoRA还有助于减轻模型过拟合的倾向（有关更多信息，请参见模型微调和性能评估部分）。  

CoVFit的输入包括与武汉-湖北-1株S蛋白对齐的SARS-CoV-2 S蛋白的氨基酸序列。这些对齐序列可以由Nextclade生成。CoVFit可以预测给定S蛋白序列在17个国家的适应性（Re）值以及逃避1,548种mAbs的能力（图S1A）。 

CoVFit模型的训练在配备单个Nvidia A100 GPU（40GB）的计算节点上完成，每个实例需24小时。因此，该模型可以使用最新的基因组监测数据定期更新，无需大量的计算资源。  

利用五折交叉验证方案，我们生成了五个CoVFit模型实例，使我们能够估计这些模型的平均预测值及其不确定性（图1B）。选择这种方法是因为，特别是关于未来变体的适应性的预测值在训练好的不同模型实例之间可能会有所不同（图3）。 

### CoVFit实施

可用的ESM-2模型具有不同的参数大小27（https://github.com/facebookresearch/esm）。在这些模型中，我们使用了具有650M参数的版本，优先考虑预测性能与计算成本之间的平衡。根据官方在非监督接触预测任务中的基准测试，这种650M参数的模型的性能比具有20倍更少参数的35M参数模型高出1.7倍。然而，与具有20倍更多参数的150亿（B）参数模型相比，650M模型的性能增益相对较小，仅为1.08倍。此外，最近的一篇预印本中的系统分析表明，增加蛋白语言模型的参数大小并不一定能提高蛋白结构预测任务之外的预测性能43。鉴于这一见解，我们选择不使用大于650M模型的模型，如3B或15B模型，进行我们的研究。  

ESM-2模型的最大输入序列长度为1024个氨基酸，这是因为自注意力的计算需求，需要的内存与序列长度的平方成比例（O(L^2)）。不幸的是，武汉-湖北-1株的S蛋白由1,273个氨基酸组成，超过了模型的限制。因此，超过1024位的氨基酸序列（氨基酸1,025–1,273；S2亚单位的C末端）被截断，未在ESM-2模型中使用。这是CoVFit的一个技术限制。尽管如此，预计这一限制对性能的影响将是最小的，考虑到突变主要发生在S1亚单位（氨基酸1-681）中，而S2亚单位（氨基酸682-1,273）保持高度保守并且突变较少。  

CoVFit 是使用 Python 3.11.4、NVIDIA CUDA 12.1.0、PyTorch 2.1.0、Transformers 4.31.0 和 PEFT 0.5.0 实现的。有关 CoVFit 系统要求的更多信息可以在 GitHub 仓库（https://github.com/TheSatoLab/CoVFit ）中找到。计算代码在配备了一块 NVIDIA A100 GPU 和 40GB RAM 的超级计算机节点上执行，除非另有说明。  

为了建立 ESM-2Coronaviridae 模型，进行了领域适应，使用了 Delvin 等人描述的掩蔽语言学习方案。在领域适应中，使用了为领域适应准备的 S 蛋白数据集。在我们的模型领域适应训练中，每个输入序列的 15% 的位置被随机掩蔽，每个掩蔽位置有 80% 的概率成为 <mask> 令牌，10% 的概率保持错误，以及 10% 的概率保持原样。随后，这 15% 的位置的氨基酸或令牌类型在分批训练步骤中被预测，并通过交叉熵损失函数更新模型权重。  

使用上述方案，我们训练了拥有 650M 参数的 ESM2 模型，该模型配备了通过 Hugging Face Transformers 库实现的 MaskedLM 层。模型训练了 30 个周期。批量大小设置为 5，基础学习率为 2e−5，使用了一个周期的预热，并实施了基于余弦的学习率调度器在训练期间逐步降低学习率。  

为了比较 ESM-2Coronaviridae 模型与原始 ESM-2 模型的推理能力，我们在掩蔽的 SARS-CoV-2 S 蛋白序列上对两个模型进行了推理。由于我们的领域适应训练数据集包括到 2022 年 8 月 31 日为止出现的基因型，因此我们使用在 2022 年 9 月 1 日之后出现的基因型进行推理。训练中使用的相同掩蔽参数也被用于推理。测试数据集上的结果被转换为困惑度分数，即在推理期间计算的交叉熵损失值的指数。困惑度分数表示模型在做出预测时的确定性，分数越低表示确定性越高。在我们的推理结果中，原始的 ESM-2 模型的困惑度分数为 11.38，而 ESM-2Coronaviridae 模型的困惑度分数为 1.17，显示出经过领域适应训练后预测确定性更高。  

为了评估领域适应可能对模型原始推理能力的负面影响，我们再次比较了原始的 ESM-2 和 ESM-2Coronaviridae 模型，这一次是在 2018 年 3 月发布的 UniRef50 的蛋白序列样本上进行的。从全量的 3,016,211 个序列中随机抽样了 29,950 个序列进行评估。和之前一样检查了两个模型的困惑度值，原始的 ESM-2 模型的困惑度分数为 6.76，而 ESM-2Coronaviridae 模型的困惑度分数为 6.86，表明该模型在领域适应后仍保持了对一般蛋白的推理确定性。  

我们在 Python v3.10.9、CUDA v12.1.1 和 torch v2.1.0.dev20230601 环境下，使用 Hugging Face Transformers v4.34.1 库进行了领域适应训练。计算是在配备了单个 NVIDIA RTX 6000 Ada GPU 和 48GB RAM 的计算机上执行的。更详细的实施信息可在 GitHub 仓库（https://github.com/TheSatoLab/CoVFit） 中找到。  

### CoVFit的模型架构

对于多任务学习部分，我们为ESM-2模型设计了定制的任务特定回归头（见图S1A）。在ESM-2的嵌入层上，设置了一个维度等于任务数量的线性层作为任务特定头。此外，还设置了一个中间线性层，维度为252，用以连接嵌入层和任务头层。  

在CoVFit中，由于多任务学习框架，单个输入序列与多个目标变量相关联。例如，关于DMS数据，典型的S蛋白变异体（输入序列）与超过1000个mAbs（目标变量）的相对结合亲和力值相关联。为了提高计算效率，CoVFit采用了一种架构，可以并行处理单个输入序列及其多个对应的目标变量，而不是顺序处理同一输入序列和一个目标变量的配对（见图S1B）。因此，与单个输入序列相关的多个目标变量的损失值可以同时计算。  

然而，每个输入序列相关的任务数量可能有很大差异，尤其是在用于适应性预测的变异S蛋白序列（最多17个任务）与用于DMS预测的突变序列（最多1548个任务）之间进行比较时。因此，每个数据集的损失值的大小可能会有显著差异，这可能导致训练不稳定。为了稳定训练过程，CoVFit使用不重叠的随机抽样创建数据块，其中单个输入序列与最多10个任务的目标变量相关联。然后，这些生成的序列-变量块被用作训练输入。对于损失函数，CoVFit采用了一种根据各个任务加权的自定义最小二乘法。原则上，权重被确定为任务频率的倒数成比例。有一个例外是，对于在2022年1月1日之后出现的基因型的适应性预测任务，我们将权重加倍调整。  

### 模型微调和性能评估

#### 在CoVFit中，我们使用Hugging Face PEFT v.0.5.0中实现的LoRA技术，基于ESM-2定制模型进行了微调。低秩适配器被注入到关键、查询和值组件的权重矩阵中，以及密集层的权重矩阵。这些适配器和添加到ESM-2上的定制回归头进行了全面的微调，而其他原始层则保持在它们预训练的状态下冻结。使用了排名参数r=8和规模参数alpha=16。因此，在总共659,741,475个参数中，该模型有7,768,974个可训练参数，约占总数的1.18%。LoRA的dropout率设置为0.05。  

对于微调，使用了带有0.02衰减参数的AdamW优化器。最大学习率设置为2.0E-4，采用线性学习率调度器，训练持续30个周期。批量大小设置为4，梯度累积步骤为2。  

基因型-适应性和DMS数据集被随机分为训练、评估和测试数据集，比例为6:2:2。对于基因型-适应性数据集，我们考虑了国家和Nextclade分类的组合，确保每种组合的数据在训练-评估和测试数据集中均匀分布。类似地，对于DMS数据集，在数据分割过程中考虑了mAbs的类型。  

我们使用五折交叉验证方法进行了数据分割。在旨在评估模型预测未来变体性能的实验中，我们首先将基因型-适应性数据集分为两部分：一部分用于过去的变体，另一部分用于基于它们出现日期的未来变体。对于关注BQ.1、XBB、CH.1.1和BA.2.86谱系的实验，我们将截止日期设为2022年9月1日。然后我们从过去变体数据集中排除了这些特定的目标谱系。类似地，对于专门针对BA.2.86谱系的实验，我们选择了2023年8月1日作为截止日期，并从过去的数据集中移除了这个谱系。在此步骤之后，我们进一步将过去的数据集分为用于训练、验证和测试的三个子集，按照上文描述的方法进行。 

### 系统发育分析

我们创建了用于系统发育分析的数据集，这是编码相应S蛋白基因型的代表性病毒基因组序列数据集的子集（EPI_SET_ID: EPI_SET_240311ma；见基因型-适应性数据集的准备）。我们移除了符合以下标准的序列：（i）在位置265到29,673（与武汉-湖北-1参考序列（GenBank登录号：NC_045512.2）对齐）的序列中含有超过3%不明确字符的序列；（ii）根据Nextclade分类分配被归类为“重组体”的序列。此外，我们还将武汉-湖北-1参考基因组序列包括在我们的数据集中。用于系统发育分析的病毒基因组序列数据集，除了武汉-湖北-1参考基因组外，都在EPI_SET_ID: EPI_SET_240311rk下总结，可以通过GISAID网站（https://gisaid.org/）  访问。  

病毒核苷酸基因组序列使用Minimap2 v.2.17与武汉-湖北-1的参考序列对齐。此对齐随后根据GISAID系统发育分析流程（https://github.com/roblanf/sarscov2phylo） 转换为多序列对齐。在参考基因组中对应位置1-265和29,674-29,903的位点被掩盖，即转换为'NNN'，以从后续分析中排除它们。使用IQ-TREE v.2.1.4_beta构建了最大似然系统发育树，采用了GTR+I+G核苷酸替换模型。为了评估系统发育树节点的可靠性，执行了1000次复制的超快速引导分析。从构建的树推断出时间解析系统发育树，使用TreeTime v.0.11.1进行，根部定位策略设置为‘最古老’，结果由武汉-湖北-1株重新定位。也使用TimeTree和默认选项重构了祖先节点的S蛋白序列。  

### 使用CoVFit检测具有适应性提升的系统发育分支

为了推断突变通过观察到的SARS-CoV-2演化对适应性的影响，我们分析了SARS-CoV-2系统发育树所有分支上预测适应性的增加，如系统发育分析部分所述。我们使用通过五折交叉验证开发的五个CoVFitNov23模型，预测树内现有和重构的祖先S蛋白序列的适应性值。由于CoVFit在多个国家进行适应性预测，我们将这些预测平均化，以获得每个序列的单一代表适应性值，结果为每个序列五个代表适应性值。我们比较了每个节点及其祖先节点之间的这些值，并计算了连接它们的分支的平均适应性增益。使用Welch的t检验确定适应性变化的统计显著性，并通过Benjamini-Hochberg方法应用多重检验校正。误差发现率（FDR）小于0.1的分支被认为具有统计学意义。我们还通过比较分支两端的S蛋白序列，识别了沿每个分支获得的突变。检测到的适应性提升事件在表S3中总结。  

### 使用公开可用的DMS数据表征F456L替换

根据Cao等人提供的mAbs的能力的DMS数据（https://github.com/jbloomlab/SARS2_RBD_Ab_escape_maps ），使用基于DMS数据的逃逸估计器32计算了免疫逃逸的逐位置评分（见图5C）。对于ACE2结合和蛋白表达的DMS数据，我们检索了Taylor和Starr31呈现的每个位点的变异评分结果（https://github.com/tstarrlab/SARS-CoV-2-RBD_DMS_Omicron-XBB-BQ/blob/main/results/final_variant_scores/final_variant_scores.csv ）。我们筛选了位于456位置的突变体L，并检索了每个变异目标的‘delta_bind’和‘delta_expr’值（表示多次重复实验的平均值减去参考残基的平均值）（见图5D）。  

### 基于CoVFit的体外（深度）突变扫描分析

使用CoVFitNov23模型的实例来推断S蛋白突变体的适应性。首先，计算每个突变体在不同国家的平均适应性值。随后，这些平均值在所有五个CoVFitNov23模型实例中进行平均，得出每个S蛋白突变体的单一平均适应性值。这个简化的适应性值然后与原始骨架S蛋白序列的适应性进行比较。

### 对JN.1亚型的流行病学分析

我们从GISAID（https://gisaid.org/ ）检索了截至2024年3月11日的所有SARS-CoV-2基因组序列及其相关元数据。为确保数据质量，根据以下标准排除了某些序列：(i) 采集日期缺失；(ii) 样本来自非人类动物；(iii) 超过2%的核苷酸未确定；或(iv) 样本在隔离期间收集。我们专注于JN.1谱系，特别是被标记为“VOI GRA (JN.1+JN.1.1*)”的谱系，这些样本收集于2023年12月1日至2024年2月29日（EPI SET ID: EPI_SET_240315fc）。我们将JN.1谱系分为五组：含F456*的JN.1，含R346*的JN.1，含K478*的JN.1，同时含F456*和R346*的JN.1，以及其他JN.1谱系，其中星号表示任意氨基酸类型。这五个JN.1类别的频率每7天计算一次，针对JN.1人群内的每个地理区域。由于序列总数较低（n = 216），排除了非洲的数据。

### 方法论讨论：改进CoVFit的空间

我们认识到CoVFit在未来发展中有多个可能改进的领域。首先，由于我们当前的模型仅训练了S蛋白序列，可能通过包括额外病毒蛋白的信息来提高其性能。以前的研究已经发现，在非S蛋白中也有与适应性增加相关的突变，特别是在核衣壳（N）蛋白中，这支持了这种方法的可能有效性。在当前设置中，非S蛋白中的突变效应被吸收为与这些突变有连锁不平衡关系的S蛋白中的突变效应。然而，与其他病毒蛋白相比，S蛋白对适应性的影响尤其强烈。因此，不清楚通过添加来自其他病毒蛋白的信息，预测精度会在何种程度上提高。甚至可能因为包括其他病毒蛋白而降低泛化能力，因为信噪比会降低。考虑到增强病毒适应性的突变主要发现在S蛋白的S1亚单位中，仅将S1亚单位作为输入可能会导致更高的信噪比，提供更有效的方法。  

第二，也可能通过包括各种DMS数据来提高性能，如其他病毒表型的数据。在本研究中，我们仅使用了针对mAbs免疫逃逸能力的DMS数据。然而，鉴于S蛋白与ACE2的结合亲和力对适应性的显著影响，使用这一特征的DMS数据可能提高预测性能。在我们的初步实验中，我们发现与其他任务相比，ACE2结合亲和力的DMS数据的收敛速度要慢得多。考虑到同时学习的难度，我们决定在本研究中不使用这种DMS数据。同样，虽然我们使用了基于祖先株（D614G）的DMS数据，但纳入使用其他变体（特别是最近出现的变体）的S蛋白进行实验获得的DMS数据可能进一步提高预测性能。  

#### 第三个考虑是模型的扩展。通常认为，随着语言模型的增大，其性能会提高。确实，使用ESM-2进行的基准测试表明，将模型大小从本研究中使用的650M变为3B或15B，可以略微提高蛋白质结构预测性能。对于我们的方法，使用像3B或15B这样更大的模型也可能提高性能。最近开发的技术，如基于量化的LoRA（QLoRA），使得即使在有限的GPU资源下也能对15B模型进行微调成为可能。然而，我们遇到了CoVFit与QLoRA之间的不兼容问题，导致我们放弃了基于QLoRA的模型开发。还应注意，扩大模型规模可以显著增加训练和推理时间。  

#### 第四个考虑是适应性数据的数据增强。在病毒基因组监测中，样本采集日期与数据提交到数据库之间可能会有几周到几个月的延迟。此外，在病毒基因组监测中，近年来新测序的病毒基因组数量逐渐减少。因此，最新的基因组数据往往采样不足。然而，这些最新数据被认为包含比旧数据更多对预测未来变体的关键信息。因此，增加训练数据集中最新数据的比例或使用数据增强技术（人工扩展数据集）可能增强模型对未来变体的泛化能力。  

最后，由于我们没有对模型的超参数进行详尽的调查，通过调整它们可以提高模型的性能。可调整的超参数包括数据标准化方法、网络架构、任务权重平衡、优化器算法、学习率和最大周期数。  



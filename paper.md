# A Protein Language Model for Exploring Viral 1 Fitness Landscapes
摘要  
连续出现的SARS-CoV-2变种导致了通过增强的传播潜力（即适应性）重复的疫情激增。建模基因型与适应性的关系使我们能够准确指出增强病毒适应性的突变，并在检测到高风险变种后立即进行标记。在此，我们介绍了CoVFit，这是一个蛋白质语言模型，能够仅根据其刺突蛋白序列预测变种的适应性。CoVFit的训练使用了从病毒基因组监测和与免疫逃逸相关的功能性突变数据中得到的基因型–适应性数据。仅限于在XBB出现前的可用数据，CoVFit成功预测了XBB谱系的更高适应性。经充分训练的CoVFit识别了直到2023年底SARS-CoV-2进化过程中的549个适应性提升事件。此外，基于CoVFit的模拟能够在检测到之前预测JN.1亚型的更高适应性。我们的研究提供了对SARS-CoV-2适应性格局的洞察，以及一种可能转变病毒基因组监测的新工具。  

## 引言

控制病毒性传染病的主要挑战之一源于病毒通过突变进化的能力。在COVID-19大流行期间，具有增强传播潜力（即适应性）的SARS-CoV-2变体在宿主群体中相继出现，导致了一次又一次的疫情激增。通过研究SARS-CoV-2的方式了解病毒如何在大流行中增强其适应性，我们可以获得管理COVID-19以及未来病毒性传染病的关键洞察。  

SARS-CoV-2变体的适应性可以通过有效再生数（Re）进行比较。Re代表在特定条件下，一个感染者引起的平均次级感染数。由于病毒基因组监测的进步，现在几乎可以实时估算SARS-CoV-2变体的相对Re。基于估计的相对Re，我们可以预测在特定时间内，在共同流行的病毒中哪个变体具有最大优势，可能会成为下一个主导变体。我们的团队，G2P-Japan联盟，已经成功使用Re估计来预测即将出现的主导变体，并通过病毒学实验进一步阐明了这些变体的特征和风险。  

由于变体在特定条件下的适应性由其基因型决定，原则上可以从其基因组或蛋白质序列预测变体的适应性。通过建立适应性预测模型，我们可以识别有助于增加病毒适应性的突变。此外，一个可靠的适应性预测模型将使变体监测系统更为高效，理想情况下能够在最初的基因组序列公布时即刻识别下一个主导变体。更重要的是，由于病毒通常朝着增加其适应性的方向进化，了解病毒的适应性格局可以预测其进化方向。  

SARS-CoV-2通过在病毒蛋白中获得突变（包括替换、插入和删除），尤其强调刺突（S）蛋白，来增强其适应性。S蛋白是病毒通过与血管紧张素转换酶2（ACE2）受体相互作用进入宿主细胞的必需糖蛋白。同时，S蛋白是中和抗体的主要靶标，这些抗体是疫苗接种或自然感染引发的体液免疫反应的关键组成部分。因此，能够影响S蛋白与ACE2的结合效率及其逃避中和抗体的能力的突变往往对病毒适应性有更强的影响。  

SARS-CoV-2的进化过程可以分为顺序和非顺序（或跃变式）两种。Omicron BA.1、BA.2、XBB和BA.2.86谱系是通过跃变式过程出现的，通过各种机制（包括重组等）在S蛋白中获得了大约15个以上的突变。相比之下，Omicron BA.5、BQ.1.1及XBB的后代是从其亲本谱系顺序进化而来的，在S蛋白中获得的突变数量较少，通常为三个或更少。预测通过跃变式进化出现的变体的适应性，预计将比通过顺序进化出现的变体更具挑战性。  

以往的研究，包括我们的研究，已经开发出了基于变体的突变模式预测其适应性的方法，这些方法采用统计建模方法。然而，这些统计模型仅将适应性表示为个别突变效应的线性组合，没有考虑突变之间的相互作用，即上位性。此外，这些统计模型无法考虑到训练数据集创建时尚未出现的突变的效应。我们认为，这些挑战可以通过使用创新的蛋白质语言模型来解决。大型语言模型（LLMs）在自然语言处理领域越来越受欢迎。蛋白质语言模型是在蛋白质序列的综合数据集上预训练的LLMs，使其能够学习蛋白质的一般模式。值得注意的是，我们可以对预训练的蛋白质语言模型进行微调，以解决特定任务，如适应性预测。此外，通过采用适用于深度学习模型（如蛋白质语言模型）的多任务学习框架，我们可以将突变的功能信息整合到适应性预测过程中，从而可能提高模型的预测准确性。  

在这项研究中，我们开发了CoVFit，这是一个利用最先进的蛋白质语言模型ESM-2，基于S蛋白预测SARS-CoV-2变体适应性的模型。我们使用基于病毒基因组监测估计的基因型-适应性信息，以及通过高通量深度突变扫描（DMS）实验确定的关于逃避体液免疫能力的突变效应信息，对定制的ESM-2模型进行了微调。此外，使用CoVFit，我们描绘了直到2023年底的SARS-CoV-2适应性格局。  

## 结果
引入CoVFit
我们开发了CoVFit，这是一个基于S蛋白序列的适应性预测模型，通过对ESM-2进行微调（见图1A）。为了增加模型对冠状病毒S蛋白的了解，我们首先通过对从1506种冠状病毒中获得的S蛋白序列进行额外的预训练（即领域适应），建立了ESM-2Coronaviridae（见图1B和图S1）。ESM-2Coronaviridae模型在特定于SARS-CoV-2 S蛋白的掩码学习任务中表现出增强的预测能力，同时保持在更广泛的蛋白质集合中的性能（见图S1C）。随后，利用多任务学习框架，我们在基因型–适应性（Re）数据和DMS数据上对模型进行了微调，用于评估抗体中和逃逸能力（见图1B）。因此，对于给定的S蛋白序列，CoVFit可以预测特定国家的适应性值及其从每种单克隆抗体（mAb）逃逸的能力（见图S1A）。  

为了组建基因型–适应性数据集，我们首先将病毒序列分类为S蛋白基因型，定义为一组共享S蛋白中一组独特突变的病毒。随后，我们通过将多项逻辑模型拟合至2023年11月2日前从GISAID（https://gisaid.org/）获得的基因组监测数据，估算了每个基因型在每个国家的Re，如之前所述。因此，我们获得了总共21,751个基因型–适应性数据点，涵盖了17个国家中的12,914个基因型（见图1B和图S2A）。与先前的研究一致，后期出现的变体展示出更高的Re值，表明变体的Re在进化过程中逐渐增加（见图S2A）。  

我们利用了由Cao等人产生的关于单克隆抗体（mAbs）中和能力的体外DMS数据集。该数据集包含173,384个突变–mAb DMS数据点，涵盖S蛋白受体结合域（RBD）中的2,096种类型的突变和1,548种mAbs（见图1B和图S2B）。与先前的发现一致，突变对mAbs的影响因其抗原表位类别而异（见图S2B、S2C和S2D）。表现出更高适应性的变体，如BQ.1.1或XBB，显示出增强的逃避这些mAbs的能力，支持利用这些信息预测适应性的有效性（见图S2D）。  

使用五折交叉验证方案，我们生成了五个CoVFit模型实例（见图1B）。这些模型实例用于评估相应测试数据的性能。此外，这些实例可以为新数据（例如，在模型训练后获得的数据）提供预测的均值和方差。从此以后，这些模型实例被称为CoVFitNov23（下标表示获得基因型-适应性数据的月份和年份）。   






